package com.henryxi.jmh.string;

import org.openjdk.jmh.annotations.*;
import org.openjdk.jmh.runner.Runner;
import org.openjdk.jmh.runner.RunnerException;
import org.openjdk.jmh.runner.options.Options;
import org.openjdk.jmh.runner.options.OptionsBuilder;

import java.util.Arrays;
import java.util.HashSet;
import java.util.concurrent.TimeUnit;

@BenchmarkMode(Mode.AverageTime)
@OutputTimeUnit(TimeUnit.MICROSECONDS)
@State(Scope.Benchmark)
public class JMHStringContainsClient {
    private String tobeTestStr;
    private HashSet<String> set;

    @Benchmark
    public void stringContains() {
        tobeTestStr.contains("BBB445BB0ACC7AEFBA6D2F6AB3AE04D5");
    }

    @Benchmark
    public void setContains() {
        set.contains("ACC5D8BFFF1AB42FD2262E0C78BFD93D");
    }

    @Setup
    public void setUp() {
        tobeTestStr = "2E35E78217C01E86D5EFEA212BCC251D,92EB71A01288709581743D0D5DB9A65B,0EC7109F6324422DF01A5FE37085703D,FDE9CB2531B2450CD8B81179FCD368FE,2C8E31512E50706A4F37B8D9313E3E47,FD86D2423B4D7C500FEEB13966BCF9C7,678F7E739526D4A9413E390E9FA87CC1,52B8E9791796B641A17E713818D8BD49,2B9531ED2961D2EC79EDDEA08E619E03,75EE5DC453814FE2E1EB78A7D93C77C7,2C4138BFFAC938E6DF052CDB999729B6,85DA08C5AF11915DF71DBC8B0D16ABE0,BF3D91F6F2F6BD2C5092AB37F853F8EE,899CF065B40A7AADD079AABCD1947F8B,A23F197D980D0089A7BD97F2F562199E,052D53A137136A6820085BDE2B4A2181,A286197F5F3AF317A908ED52658D0263,3F96EC672CDBB3E86961580CD0A2277D,CB26BC81051AC1FFBC678DA39F757AF4,F8ABD455AEC6CAB7DC80BADEE0720658,F0D6F7447C7BB37F462B4A2AA7786734,2764121787BA739E60437159C5051304,6F95C93B31FC14194E624ACEF0926878,DBC45A0546E892AD64225246F1830CFF,E14A2CB33DEEFF3637BE75470E914419,519221E67AAA7A8EA7F0E96AB1893ED1,19C670E7D833763185969451EDBB0BAB,F526C4BE87EC51295E0F5E410759F293,4A82C8D621DD341A0F9BF779E11936CA,139E63729B90F546AFF6B47B7DBE3A87,E94031D799338EF4B19218EABBFB6438,FB4F87061CA23BCBAC227450AC09626E,9C54D87212523062FD3B18938C6DC591,B6D11D2C63085E70135559D7EAE57AA2,0AC46023521D5D498822EE94A1402D3B,9F2E23FB8DEE68A6264EED6B36E0C75A,B2BC0881AF9BEE2E17B4C1C51B741C98,017C908390503562F119CAB4361C7A4B,9878FDF4A8D5651172AFD0BA86D4F6F3,28B9E58F6E5C5A8C287CDF04BFCD22B0,B5A2860C2901C83C4E4678079E1B75B0,7E1ADAF3E84B8CD708058ACE766FC747,63FE490A179AB2C9A2B14E27593E8DF6,EB207A53B7F757CB90FC5A1B85E029F1,B56CA419DB79F95AA2A5E331875CC043,5A136F1EBAEA534802F8166F38897FE4,D8C209DD3665ED513CDF5F7A661DB388,E3B5EFE1A8FEF5191C85703AC9232EAC,863D34A2AA46D95AB358DCF63ED9ECCD,BA05418BA17C5F4181358B1A9CE8C773,076D65DF61658174F1293A7492EF7189,0AD64A00EC3E36F5770F16B5380857C9,FAC2BAF10479C136AB92855F598F145D,C1894A19FDFBC5C845B6028D44FA5C64,89E426798692548C1DBC41F4A37057C9,6F2B9248973F58C46FF50384D11CB4EF,A9D33A0218A0498E08A476DBB21C3A33,6B3543F2D95A64AD9900B83CFB80CE27,4456AE919A117EB9308C172063863F4C,729456D88568C6FD6284E0FCBAD99092,FB083FFAB6462D0B362EED6E8BFA4252,116047E4F77E5BC8AFAE497BE9DD80B7,0582350D937DC9DD8DD2393F85D325C2,BBB445BB0ACC7AEFBA6D2F6AB3AE04D5,A729D2A6D11817486E004478898772D3,63137E49EFF8458BC5F7C063F105BFF6,1B8DFB52B8EE6195149ED770040BBFD6,D258AEBB8B72EA8F0320B7459947A860,990BC5E3B5D13C9E56EDF878F7CE7B0B,B510F48C2E77D9BD2811DDAA18467EBE,751A96CBDDE90C94F2FDD922A514185B,419C11D34221548909589BA8AE4D8F7C,E85A0DE7E06A88A026561E0768EF3708,E00744D64D88F1C9999234690134DC9C,14BE9ADD6C61D75271A859AD2474752E,FF422D4D3FFADD35EAAA4DF7ED61CA86,C9FAA645328A7774ADA677C42F256563,86F6336DB6C7898FB4B1EA553EA9171E,ACC5D8BFFF1AB42FD2262E0C78BFD93D";
        set = new HashSet<>(Arrays.asList(tobeTestStr.split(",")));
    }

    public static void main(String[] args) throws RunnerException {
        Options opt = new OptionsBuilder()
                .include(JMHStringContainsClient.class.getSimpleName())
                .forks(2)
                .warmupIterations(5)
                .measurementIterations(5)
                .build();

        new Runner(opt).run();
    }
}
